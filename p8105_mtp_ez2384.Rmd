---
title: "Data Science I, Midterm Project"
output: github_document
---

```{r Packages, message=FALSE}
# Load Necessary Packages
  library(ggplot2)
  library(tidyverse)
  library(dplyr)
  library(tidyr)

# Preliminary Loading of All Datasets
  NYC_Rental_Price = read.csv("./NYC Rental.csv")
  NYC_Zipcode      = read.csv("./NYC Zipcode.csv")
  US_Housing_Price = read.csv("./US Housing 2023.csv")

```

### Problem 1: Data Import and Cleaning

##### Raw Dataset Description   
- `NYC_Rental_Price Dataset`    
  - Description: contain detailed NYC Rental Prices between Jan.2015 to Aug.2024 listed by zip codes   
  - Dimension: `r nrow(NYC_Rental_Price)` x `r ncol(NYC_Rental_Price)`    
  - Issues:   
    - ambiguous column names        
      - Column name `RegionName` actually consists entirely of zipcode information, which is very misleading.   
      - Column names of form `X2015.1.31` should be renamed for better readability.    
    - redundant columns   
      - Column `RegionID` is useless as we can treat the zipcode variable as the unique identifier.
      - The entire dataset is within NYC so columns `StateName`, `State`, `City`, `Metro` can be removed.
      - Column `SizeRank` is never used for future analysis.
      - Column `RegionType` has only `r n_distinct(NYC_Rental_Price$RegionType)` level of value and is useless.
    - too much missing data    
  - Data Cleaning Strategy:
    - Rename and Keep only the following columns: `county`, `zipcode`, and all date columns of form `%yyyy%mm%dd`.
    - If missing data is zipcode then remove that particular observation entirely.    
      Otherwise, Replace all missing values to "missing" (if character), to 0 (if numeric).
- `NYC_Zipcode Dataset`   
  - Description: contain detailed zipcode-location associations within NYC    
  - Dimension: `r nrow(NYC_Zipcode)` x `r ncol(NYC_Zipcode)`    
  - Issues:
    - redundant columns
      - Only column `County`, `ZipCode` is useful.
  - Data Cleaning Strategy:
    - Rename and Keep only columns `county` and `zipcode`.
- `US_Housing_Price Dataset`    
  - Description: contains detailed housing prices information within entire U.S. associated with specific area    
  - Dimension: `r nrow(US_Housing_Price)` x `r ncol(US_Housing_Price)`   
  - Issues:   
    - ambiguous columns   
      - Column name `RegionName` actually consists entirely of zipcode information, which is very misleading. 
      - Column names of form `X2015.1.31` should be renamed for better readability.  
    - redundant columns   
      - Only zipcodes, State, and date columns are used in future analysis.   
    - missing data
  - Data Cleaning Strategy:   
    - Rename and Keep only variables `zipcode`, `state`, and all date columns of form `%yyyy%mm%dd`.
    - Remove entire record if contains NA values for zipcode;    
      otherwise replace all missing string data to "missing" and all missing numeric values to 0.
##### Data Cleaning Code Chunk

```{r Raw Data Cleaning}

  NYC_Rental_Price = NYC_Rental_Price %>% janitor::clean_names() %>% select(-region_id, -size_rank, -region_type, -state_name, -state, -city, -metro) %>%
                     rename("zipcode"="region_name", "county"="county_name") %>% mutate(county=gsub(" County","",county)) %>% mutate(across(where(is.numeric), \(x) round(x, 2))) %>%
                     mutate_if(is.character, ~ replace_na(., "missing")) %>% mutate_if(is.numeric, ~ replace_na(., 0)) %>% arrange(zipcode)
                     colnames(NYC_Rental_Price)[3:ncol(NYC_Rental_Price)] <- colnames(NYC_Rental_Price)[3:ncol(NYC_Rental_Price)] %>% sub("x", "", .) %>% gsub("_", "/", .) %>%
                                                                             sub("(\\d{4})/(\\d{1})/(\\d{2})", "\\1/0\\2/\\3", .)
                     
  NYC_Zipcode = NYC_Zipcode %>% janitor::clean_names() %>% select(county, zip_code) %>% rename("zipcode"="zip_code") %>% arrange(zipcode) %>% relocate(zipcode)
  
  US_Housing_Price = US_Housing_Price %>% janitor::clean_names() %>% select(region_name, state, starts_with("x")) %>% rename("zipcode"="region_name") %>%
                     mutate_if(is.character, ~ replace_na(., "missing")) %>% mutate_if(is.numeric, ~ replace_na(., 0)) %>% arrange(zipcode)
                     colnames(US_Housing_Price)[3:ncol(US_Housing_Price)] <- colnames(US_Housing_Price)[3:ncol(US_Housing_Price)] %>% sub("x", "", .) %>% gsub("_", "/", .) %>%
                                                                             sub("(\\d{4})/(\\d{1})/(\\d{2})", "\\1/0\\2/\\3", .)

  NYC_Rental_Price
  NYC_Zipcode
  US_Housing_Price
                     
```

##### Report Objectives   














